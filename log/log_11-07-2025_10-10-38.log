2025-07-11 10:10:38.200 | ERROR    | adapters.download_file:download_index:46 - Error: [Errno 13] Permission denied: 'index_file.xlsx'
Traceback (most recent call last):

  File "c:\Users\rouajul\Desktop\ema_rcp-main\app\main.py", line 20, in <module>
    df_authorised, df_withdrawn = asyncio.run(download_index(url_index_file, index_file_path))
                                  │       │   │              │               └ 'index_file.xlsx'
                                  │       │   │              └ 'https://www.ema.europa.eu/en/documents/report/medicines-output-medicines-report_en.xlsx'
                                  │       │   └ <function download_index at 0x00000204776B09A0>
                                  │       └ <function run at 0x000002047714F240>
                                  └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\\...

  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           │      │   └ <coroutine object download_index at 0x0000020480CCA0E0>
           │      └ <function Runner.run at 0x0000020477504860>
           └ <asyncio.runners.Runner object at 0x0000020480BE1FD0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<download_index() running at c:\Users\rouajul\Desktop\ema_rcp-main\app\adapters\download_fil...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000020477502340>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000020480BE1FD0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 712, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000204775022A0>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 683, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000204775040E0>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2042, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000020477432B60>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002047FC60790>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.1520.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002047FC60790>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002047FC60790>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002047FC60790>()>

> File "c:\Users\rouajul\Desktop\ema_rcp-main\app\adapters\download_file.py", line 34, in download_index
    with open(index_file_path, "wb") as f:
              └ 'index_file.xlsx'

PermissionError: [Errno 13] Permission denied: 'index_file.xlsx'
